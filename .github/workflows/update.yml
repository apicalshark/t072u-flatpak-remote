name: 'Update Flathub Dependencies'

on:
  #schedule:
  #  - cron: '0 0 * * *' # Runs daily at midnight UTC
  workflow_dispatch: {}

jobs:
  update-dependencies:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        branch: [ 'master' ]

    steps:
      - name: 'Checkout repository'
        uses: actions/checkout@v4
        with:
          ref: ${{ matrix.branch }}
          submodules: 'recursive'

      - name: 'Run flatpak-external-data-checker'
        continue-on-error: true
        uses: docker://ghcr.io/flathub/flatpak-external-data-checker:latest
        with:
          args: --update onion.torzu_emu.torzu.json
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          GIT_AUTHOR_NAME: 'Flatpak External Data Checker'
          GIT_COMMITTER_NAME: 'Flatpak External Data Checker'
          GIT_AUTHOR_EMAIL: '41898282+github-actions[bot]@users.noreply.github.com'
          GIT_COMMITTER_EMAIL: '41898282+github-actions[bot]@users.noreply.github.com'